---
title: "Sampling P-Values"
author: "Rohan Mishra"
date: "9/9/2022"
output:
  word_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

rm(list=ls())
library(HMPTrees)
library(data.table)
library(tidyverse)
#library(akima)
options(scipen=9999)
load("forSampling.RData")



```


Fei asked if we selected normal graphs only what would the P value be?

We know the gstar for all 100 graphs - Rohan calculated that. If we randomly sampled with replacement 50 graphs from the 100 graphs and calculated gstar we would expect to have about the same gstar as for the 100 graphs. This is because we are sampling from the same distribution and therefore should get the same parameter estimates.

Do the following:

    Sample 50 graphs from the 100 randomly with replacement and put them into group 1
    Sample 50 graphs from the 100 randomly with replacement and put them into group 2
    Calculate and store P from the LRT
    Repeat steps 1-3 1,000 times
    Plot the histogram of the 1,000 P values

I predict it will be uniform from 0 to 1



One result presented to Fei & Ronghao was the p-value from a liklihood ratio test of two sets of graphs: Normal & Abnormal graphs. Fei asked what the P-value would be if we randomly selected sets of graphs to compare to each other. 

In this report, we randomly select 25 graphs from the 100 in the entire reaction into two seperate sets & run the LRT. This is done 1000 times, giving us 1000 p-values. These P-values are then plotted on a histogram to observe the frequencies of these P-values.

Formally,
    1. Sample 25 graphs from the 100 randomly with replacement and put them into group 1
    2. Sample 25 graphs from the 100 randomly with replacement and put them into group 2
    3. Calculate and store P from the LRT
    4. Repeat steps 1-3 1,000 times
    5. Plot the histogram of the 1,000 P values

Below, we show the first 5 rows and columns of our 100 graphs. Each column represents one graph. These graphs can be visualized as nodes (represented by the sensors) and edges (represented by each value in the column).

```{r showing some graphs}

x[,1:5]

```

Below, we show the code ran to generate the histogram of P-Values. (delete this before sending this out, just for my reference).

pvalStor <- NULL
for(i in 1:1000) {
  x <- new_cors
  grp = sample(1:100, 25, replace = TRUE)
  x1 <- x[,grp]
  grp2 <- sample(1:100,25,replace = TRUE)
  x2 <- x[,grp2]
 
  p <- compareTwoDataSets(x1, x2, numPerms = 100)
  pvalStor[[i]] <- p
}

hist(pvalStor)





```{r histogram, echo=FALSE}
par(mfrow=c(1,1))
hist(pvalStor, main = "Histogram of P-Values")

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r Sampling from Different Distributions}

pValSampleSizeList <- as.list(rep(NA,10))
for(j in c(3,4,5,6,10,15,20)) {
  print(j)

  #par(mfrow=c(2,2))
  pvalStor2 <- vector(length = 100)
  for(i in 1:100) {
    x <- new_cors
    grp = sample(c(1:70,90:100), j, replace = TRUE)
    x1 <- x[,grp]
    grp2 <- sample(70:90,j,replace = TRUE)
    x2 <- x[,grp2]

    p <- compareTwoDataSets(x1, x2, numPerms = 100)
    pvalStor2[i] <- p
  }
  pValSampleSizeList[[j]] <- pvalStor2
  hist(pValSampleSizeList[[j]], main = paste("Histogram of P-Values-", j, "Samples", sep = " ")
       ,xlim=c(0,1))
 abline(h=0)
}

power_table <- data.frame("Sample_Size" = c(3,4,5,6,10,15), 
                          "Power_Percent" = c(0,35,65,75,100,100))



```
